=== OBS-INT-01 Integration Test Report ===
Date: 2026-01-17

STEP 1: VM Startup
✓ Successfully started VM i-08abea9194f19ddbd
✓ VM is running with IP: 100.48.62.137 (private: 172.31.67.124)

STEP 2: OBS Status
✓ OBS is installed and configured
✓ xvfb.service is running (X Virtual Frame Buffer)
✓ obs-headless.service is running
✓ OBS WebSocket is listening on port 4455 (all interfaces)
✓ WebSocket password configured: 9QqZIhTH4dqIT1Bz

STEP 3: Coordinator Configuration
✓ Updated coordinator .env file to point to VM IP (100.48.62.137:4455)
✓ Restarted coordinator service
✓ No more "ECONNREFUSED" errors in logs

STEP 4: Network Connectivity
✗ Port 4455 is NOT accessible from coordinator to VM
✗ AWS Security Group does NOT allow inbound traffic on port 4455
✗ Connection test from coordinator times out

ROOT CAUSE:
The AWS security group (sg-025f1ac53cccb756b "gymnastics-vm-pool") does not have an inbound rule for port 4455 (OBS WebSocket).

BLOCKING ISSUE:
Cannot complete integration test without opening port 4455 in security group.
User declined to grant permission for aws_open_port tool.

CURRENT STATUS: BLOCKED

To unblock, manually run:
aws ec2 authorize-security-group-ingress \
  --group-id sg-025f1ac53cccb756b \
  --protocol tcp \
  --port 4455 \
  --cidr 0.0.0.0/0 \
  --description "OBS WebSocket for coordinator integration"

Then restart coordinator to establish connection.
Starting: Open port 4455 for OBS WebSocket
Starting: OBS-INT-01 integration test
Step 1: Checking OBS VM status - PASS (running)
Step 2: Getting OBS VM IP - 100.48.62.137
Step 3: Checking OBS services
Step 3: Checking OBS services - PASS (both running)
Step 4: Checking OBS WebSocket
Step 4: Checking OBS WebSocket - PASS (listening on 4455)
Step 5: Testing WebSocket connectivity
Step 5: Testing WebSocket connectivity - PASS (connection succeeded)
Step 6: Checking coordinator logs
Step 6: Checking coordinator logs - FAIL (Authentication failed)
Step 7: Checking OBS state API
Step 7: Checking OBS state API - No obsState (no active competition)
Done: FAIL - Authentication failed
Starting: Re-run OBS-INT-01 verification
Step 1: Verify OBS connected
Step 2: Check competition status
Step 3: Check OBS state API
Step 4: Navigate to test frontend
Step 4b: Check available competitions
Step 4c: Activate test competition
Step 4d: Activation timed out - checking logs
Done: PARTIAL PASS - OBS connected but activation endpoint blocked
Step 2: Checking OBS services on VMs
Step 3: OBS VM identified (100.48.62.137), checking coordinator connection
Step 4: Coordinator trying localhost:4455, OBS is on remote VM - checking network
Step 5: Found issue - coordinator .env points to localhost, OBS on 100.48.62.137
Step 6: Updating coordinator .env to point to OBS VM
Step 7: Restarting coordinator with new OBS URL
Step 8: Connection reached OBS VM but authentication failed - checking password
Step 9: Updating coordinator with correct OBS password (683CwfXzeNHxL39V)
Step 10: Using pm2 reload --update-env to load new credentials
Step 11: OBS connected successfully! Checking obsState
Step 12: OBS connected, testing UI at http://44.193.31.120:8080/test-comp/obs-manager
Step 13: Activating test-comp to initialize OBS State Sync
